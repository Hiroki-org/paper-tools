exports.id=970,exports.ids=[970],exports.modules={91:()=>{},1446:(a,b,c)=>{"use strict";c.d(b,{cG:()=>i,ZL:()=>e});var d=c(6138);async function e(a,b=30){return(0,d.Q0)(a,b)}async function f(a){if(!a.doi)return a;let b=await (0,d.Z2)(a.doi);return b?{...a,abstract:a.abstract??b.abstract,keywords:a.keywords??b.keywords,citationCount:a.citationCount??b.citationCount,referenceCount:a.referenceCount??b.referenceCount,volume:a.volume??b.volume,issue:a.issue??b.issue,pages:a.pages??b.pages}:a}async function g(a,b=3){let c=[];for(let d=0;d<a.length;d+=b){let e=a.slice(d,d+b),g=await Promise.all(e.map(a=>f(a)));c.push(...g)}return c}let h=new Set(["a","an","the","and","or","but","in","on","at","to","for","of","with","by","from","as","is","was","are","were","been","be","have","has","had","do","does","did","will","would","could","should","may","might","shall","can","need","must","not","no","nor","so","if","then","than","that","this","these","those","it","its","he","she","we","they","them","their","his","her","our","my","your","which","what","who","whom","where","when","how","all","each","every","both","few","more","most","some","any","such","only","own","same","also","just","about","above","after","again","against","before","below","between","during","into","through","under","until","up","down","out","off","over","very","too","much","many","here","there","other","using","used","based","via","however","while","among","within","without","towards","new","well","still","even","being","because","since","given","per","two","three","one","first","second","et","al","ie","eg","etc","vs","de","le","la","show","shows","shown","paper","papers","method","methods","approach","approaches","propose","proposed","results","result","work","works","study","studies","use","provide","provides","present","presents","several","different","various"]);async function i(a,b=1,c=10,d=!1){let f=[{level:0,papers:a}],h=new Set,k=new Set;for(let b of a)if(b.doi&&h.add(b.doi.toLowerCase()),b.title){let a=b.title.toLowerCase().trim().replace(/\s+/g," ");k.add(a)}let l=a;for(let a=1;a<=b;a++){let b=function(a,b=10){let c=new Map;for(let b of a){for(let a of j(b.title))c.set(a,(c.get(a)??0)+1);if(b.keywords)for(let a of b.keywords)for(let b of j(a))c.set(b,(c.get(b)??0)+2);if(b.abstract)for(let a of j(b.abstract))c.set(a,(c.get(a)??0)+1)}return[...c.entries()].sort((a,b)=>b[1]-a[1]).slice(0,b).map(([a])=>a)}(l,5);if(0===b.length)break;let i=b.join(" "),m=await e(i,2*c);if(m=(m=m.filter(a=>{if(a.doi){let b=a.doi.toLowerCase();if(h.has(b))return!1;h.add(b)}else if(a.title){let b=a.title.toLowerCase().trim().replace(/\s+/g," ");if(k.has(b))return!1;k.add(b)}return!0})).slice(0,c),d&&(m=await g(m)),0===m.length)break;f.push({level:a,papers:m}),l=m}return f}function j(a){return a.toLowerCase().replace(/[^a-z0-9\s-]/g," ").split(/\s+/).filter(a=>a.length>2&&!h.has(a))}},3139:()=>{},6138:(a,b,c)=>{"use strict";let d,e;c.d(b,{$A:()=>o,L2:()=>x,Dz:()=>w,IG:()=>v,zP:()=>p,Z2:()=>l,ib:()=>y,Q0:()=>i});class f{constructor(a,b){this.queue=[],this.processing=!1,this.maxTokens=a,this.refillIntervalMs=b,this.tokens=a,this.lastRefill=Date.now()}refill(){let a=Math.floor((Date.now()-this.lastRefill)/this.refillIntervalMs),b=a*this.maxTokens;b>0&&(this.tokens=Math.min(this.maxTokens,this.tokens+b),this.lastRefill+=a*this.refillIntervalMs)}async acquire(){return new Promise(a=>{this.queue.push(a),this.processQueue()})}async processQueue(){if(!this.processing&&0!==this.queue.length){for(this.processing=!0;this.queue.length>0;)if(this.refill(),this.tokens>0)this.tokens--,this.queue.shift()();else{let a=this.refillIntervalMs-(Date.now()-this.lastRefill);await new Promise(b=>setTimeout(b,Math.max(0,a)))}this.processing=!1}}}async function g(a,b={},c=3,d=1e3){let e;for(let f=0;f<=c;f++){let g;try{g=await fetch(a,b)}catch(a){if(e=a instanceof Error?a:Error(String(a)),f<c){let a=d*Math.pow(2,f);await new Promise(b=>setTimeout(b,a))}continue}if(g.ok)return g;if(429===g.status){if(e=Error(`HTTP ${g.status}: ${g.statusText} for ${a}`),f<c){let a=d*Math.pow(2,f);await new Promise(b=>setTimeout(b,a))}continue}if(g.status>=400&&g.status<500)throw Error(`HTTP ${g.status}: ${g.statusText} for ${a}`);if(e=Error(`HTTP ${g.status}: ${g.statusText} for ${a}`),f<c){let a=d*Math.pow(2,f);await new Promise(b=>setTimeout(b,a))}}throw e??Error(`Failed to fetch ${a}`)}let h=new f(1,1e3);async function i(a,b=30){await h.acquire();let c=new URLSearchParams({q:a,format:"json",h:String(b)}),d=`https://dblp.org/search/publ/api?${c}`,e=await g(d),f=await e.json();return(f.result?.hits?.hit??[]).map(a=>(function(a){let b=a.authors?.author,c=[];return Array.isArray(b)?c=b.map(a=>({name:a.text??String(a)})):b&&(c=[{name:b.text??String(b)}]),{title:a.title?.replace(/\.$/,"")??"",authors:c,venue:a.venue,year:a.year?parseInt(a.year,10):void 0,doi:a.doi,url:a.url,pages:a.pages}})(a.info))}let j=(0,c(8995).createRequire)("file:///Users/hirokimukai/Cloudprojects/paper-tools/packages/core/dist/crossref-client.js")("../package.json"),k=new f(10,1e3);async function l(a){await k.acquire();let b=`https://api.crossref.org/works/${encodeURIComponent(a)}`;try{let a=await g(b,{headers:function(){let a={Accept:"application/json"},b=process.env.CROSSREF_MAILTO;return b&&(a["User-Agent"]=`paper-tools/${j.version} (mailto:${b})`),a}()}),c=await a.json();return function(a){let b=(a.author??[]).map(a=>({name:a.name??[a.given,a.family].filter(Boolean).join(" "),orcid:a.ORCID,affiliations:a.affiliation?.map(a=>a.name)})),c=a.published?.["date-parts"]?.[0]??a["published-print"]?.["date-parts"]?.[0],d=c?.[0];return{title:a.title?.[0]??"",authors:b,doi:a.DOI,year:d,venue:a["container-title"]?.[0],abstract:a.abstract,keywords:a.subject,url:a.URL,pages:a.page,volume:a.volume,issue:a.issue,citationCount:a["is-referenced-by-count"],referenceCount:a["references-count"]}}(c.message)}catch(a){if(a instanceof Error&&a.message.includes("HTTP 404"))return null;throw a}}let m=new f(5,1e3);async function n(a,b){await m.acquire();let c=`https://opencitations.net/index/coci/api/v1/${a}/${encodeURIComponent(b)}`;try{let a=await g(c);return(await a.json()).map(a=>({citing:a.citing,cited:a.cited,creationDate:a.creation}))}catch(c){return console.error(`[opencitations] failed to fetch ${a} for DOI ${b}:`,c),[]}}async function o(a){return n("citations",a)}async function p(a){return n("references",a)}let q="https://api.semanticscholar.org",r="paperId,externalIds,title,abstract,year,authors,venue,referenceCount,citationCount,isOpenAccess,openAccessPdf,fieldsOfStudy";function s(){let a=!!process.env.S2_API_KEY,b=a?"key":"no-key";return d&&e===b?d:(e=b,d=a?new f(10,1e3):new f(1,3e3))}function t(){let a={Accept:"application/json","Content-Type":"application/json"},b=process.env.S2_API_KEY;return b&&(a["x-api-key"]=b),a}async function u(a){if(a.ok)return await a.json();let b=await a.text();throw Error(`Semantic Scholar API error: ${a.status} ${a.statusText} - ${b}`)}async function v(a,b={}){await s().acquire();let c=new URLSearchParams({fields:b.fields??r,limit:String(b.limit??10)});b.from&&c.set("from",b.from);let d=`${q}/recommendations/v1/papers/forpaper/${encodeURIComponent(a)}?${c}`,e=await g(d,{headers:t()});return await u(e)}async function w(a,b=[],c={}){await s().acquire();let d=new URLSearchParams({fields:c.fields??r,limit:String(c.limit??20)}),e=`${q}/recommendations/v1/papers/?${d}`,f=await g(e,{method:"POST",headers:t(),body:JSON.stringify({positivePaperIds:a,negativePaperIds:b})});return await u(f)}async function x(a,b=r){await s().acquire();let c=new URLSearchParams({fields:b}),d=`${q}/graph/v1/paper/${encodeURIComponent(a)}?${c}`,e=await g(d,{headers:t()});return await u(e)}async function y(a,b=r,c=1){await s().acquire();let d=new URLSearchParams({query:a,fields:b,limit:String(c)}),e=`${q}/graph/v1/paper/search?${d}`,f=await g(e,{headers:t()});return await u(f)}}};