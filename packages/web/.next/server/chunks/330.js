exports.id=330,exports.ids=[330],exports.modules={91:()=>{},3139:()=>{},4174:(a,b,c)=>{"use strict";c.d(b,{C1:()=>e,c2:()=>f,d9:()=>j,aB:()=>g,nu:()=>l});var d=c(6138);async function e(a,b=1,c="both"){let f=new Map,g=new Set,h=[];f.set(a.toLowerCase(),{doi:a.toLowerCase()});let i=[a.toLowerCase()];for(let a=0;a<b;a++){let a=[];for(let b of i){let e=[];try{if("citing"===c||"both"===c)for(let a of(await (0,d.$A)(b)))e.push({source:a.citing.toLowerCase(),target:a.cited.toLowerCase(),creationDate:a.creationDate});if("cited"===c||"both"===c)for(let a of(await (0,d.zP)(b)))e.push({source:a.citing.toLowerCase(),target:a.cited.toLowerCase(),creationDate:a.creationDate})}catch(a){console.error(`Error fetching citations for ${b}:`,a);continue}for(let b of e){let c=`${b.source}->${b.target}`;for(let d of(g.has(c)||(g.add(c),h.push({source:b.source,target:b.target,creationDate:b.creationDate})),[b.source,b.target]))f.has(d)||(f.set(d,{doi:d}),a.push(d))}}if(0===(i=a).length)break}return{nodes:Array.from(f.values()),edges:h}}function f(...a){let b=new Map,c=new Set,d=[];for(let e of a){for(let a of e.nodes){let c=a.doi.toLowerCase(),d=b.get(c);d?!d.title&&a.title&&(d.title=a.title):b.set(c,{...a,doi:c})}for(let a of e.edges){let b=a.source.toLowerCase(),e=a.target.toLowerCase(),f=`${b}->${e}`;c.has(f)||(c.add(f),d.push({source:b,target:e,creationDate:a.creationDate}))}}return{nodes:Array.from(b.values()),edges:d}}function g(a,b=!0){return JSON.stringify(a,null,b?2:void 0)}function h(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function i(a){return a.replace(/[^a-zA-Z0-9]/g,"_")}function j(a){let b=[];for(let c of(b.push("digraph citations {"),b.push("    rankdir=LR;"),b.push("    node [shape=box, style=rounded];"),b.push(""),a.nodes)){let a=i(c.doi),d=c.title?h(c.title):h(c.doi);b.push(`    "${a}" [label="${d}"];`)}for(let c of(b.push(""),a.edges)){let a=i(c.source),d=i(c.target);c.creationDate?b.push(`    "${a}" -> "${d}" [label="${h(c.creationDate)}"];`):b.push(`    "${a}" -> "${d}";`)}return b.push("}"),b.join("\n")}function k(a){return a.replace(/"/g,"&#34;").replace(/\(/g,"&#40;").replace(/\)/g,"&#41;").replace(/\[/g,"&#91;").replace(/\]/g,"&#93;").replace(/\{/g,"&#123;").replace(/\}/g,"&#125;")}function l(a){let b=[];for(let c of(b.push("graph LR"),a.nodes)){let a=i(c.doi),d=c.title?k(c.title):k(c.doi);b.push(`    ${a}["${d}"]`)}for(let c of a.edges){let a=i(c.source),d=i(c.target);c.creationDate?b.push(`    ${a} -->|"${k(c.creationDate)}"| ${d}`):b.push(`    ${a} --> ${d}`)}return b.join("\n")}},6138:(a,b,c)=>{"use strict";let d,e;c.d(b,{$A:()=>o,L2:()=>x,Dz:()=>w,IG:()=>v,zP:()=>p,Z2:()=>l,ib:()=>y,Q0:()=>i});class f{constructor(a,b){this.queue=[],this.processing=!1,this.maxTokens=a,this.refillIntervalMs=b,this.tokens=a,this.lastRefill=Date.now()}refill(){let a=Math.floor((Date.now()-this.lastRefill)/this.refillIntervalMs),b=a*this.maxTokens;b>0&&(this.tokens=Math.min(this.maxTokens,this.tokens+b),this.lastRefill+=a*this.refillIntervalMs)}async acquire(){return new Promise(a=>{this.queue.push(a),this.processQueue()})}async processQueue(){if(!this.processing&&0!==this.queue.length){for(this.processing=!0;this.queue.length>0;)if(this.refill(),this.tokens>0)this.tokens--,this.queue.shift()();else{let a=this.refillIntervalMs-(Date.now()-this.lastRefill);await new Promise(b=>setTimeout(b,Math.max(0,a)))}this.processing=!1}}}async function g(a,b={},c=3,d=1e3){let e;for(let f=0;f<=c;f++){let g;try{g=await fetch(a,b)}catch(a){if(e=a instanceof Error?a:Error(String(a)),f<c){let a=d*Math.pow(2,f);await new Promise(b=>setTimeout(b,a))}continue}if(g.ok)return g;if(429===g.status){if(e=Error(`HTTP ${g.status}: ${g.statusText} for ${a}`),f<c){let a=d*Math.pow(2,f);await new Promise(b=>setTimeout(b,a))}continue}if(g.status>=400&&g.status<500)throw Error(`HTTP ${g.status}: ${g.statusText} for ${a}`);if(e=Error(`HTTP ${g.status}: ${g.statusText} for ${a}`),f<c){let a=d*Math.pow(2,f);await new Promise(b=>setTimeout(b,a))}}throw e??Error(`Failed to fetch ${a}`)}let h=new f(1,1e3);async function i(a,b=30){await h.acquire();let c=new URLSearchParams({q:a,format:"json",h:String(b)}),d=`https://dblp.org/search/publ/api?${c}`,e=await g(d),f=await e.json();return(f.result?.hits?.hit??[]).map(a=>(function(a){let b=a.authors?.author,c=[];return Array.isArray(b)?c=b.map(a=>({name:a.text??String(a)})):b&&(c=[{name:b.text??String(b)}]),{title:a.title?.replace(/\.$/,"")??"",authors:c,venue:a.venue,year:a.year?parseInt(a.year,10):void 0,doi:a.doi,url:a.url,pages:a.pages}})(a.info))}let j=(0,c(8995).createRequire)("file:///Users/hirokimukai/Cloudprojects/paper-tools/packages/core/dist/crossref-client.js")("../package.json"),k=new f(10,1e3);async function l(a){await k.acquire();let b=`https://api.crossref.org/works/${encodeURIComponent(a)}`;try{let a=await g(b,{headers:function(){let a={Accept:"application/json"},b=process.env.CROSSREF_MAILTO;return b&&(a["User-Agent"]=`paper-tools/${j.version} (mailto:${b})`),a}()}),c=await a.json();return function(a){let b=(a.author??[]).map(a=>({name:a.name??[a.given,a.family].filter(Boolean).join(" "),orcid:a.ORCID,affiliations:a.affiliation?.map(a=>a.name)})),c=a.published?.["date-parts"]?.[0]??a["published-print"]?.["date-parts"]?.[0],d=c?.[0];return{title:a.title?.[0]??"",authors:b,doi:a.DOI,year:d,venue:a["container-title"]?.[0],abstract:a.abstract,keywords:a.subject,url:a.URL,pages:a.page,volume:a.volume,issue:a.issue,citationCount:a["is-referenced-by-count"],referenceCount:a["references-count"]}}(c.message)}catch(a){if(a instanceof Error&&a.message.includes("HTTP 404"))return null;throw a}}let m=new f(5,1e3);async function n(a,b){await m.acquire();let c=`https://opencitations.net/index/coci/api/v1/${a}/${encodeURIComponent(b)}`;try{let a=await g(c);return(await a.json()).map(a=>({citing:a.citing,cited:a.cited,creationDate:a.creation}))}catch(c){return console.error(`[opencitations] failed to fetch ${a} for DOI ${b}:`,c),[]}}async function o(a){return n("citations",a)}async function p(a){return n("references",a)}let q="https://api.semanticscholar.org",r="paperId,externalIds,title,abstract,year,authors,venue,referenceCount,citationCount,isOpenAccess,openAccessPdf,fieldsOfStudy";function s(){let a=!!process.env.S2_API_KEY,b=a?"key":"no-key";return d&&e===b?d:(e=b,d=a?new f(10,1e3):new f(1,3e3))}function t(){let a={Accept:"application/json","Content-Type":"application/json"},b=process.env.S2_API_KEY;return b&&(a["x-api-key"]=b),a}async function u(a){if(a.ok)return await a.json();let b=await a.text();throw Error(`Semantic Scholar API error: ${a.status} ${a.statusText} - ${b}`)}async function v(a,b={}){await s().acquire();let c=new URLSearchParams({fields:b.fields??r,limit:String(b.limit??10)});b.from&&c.set("from",b.from);let d=`${q}/recommendations/v1/papers/forpaper/${encodeURIComponent(a)}?${c}`,e=await g(d,{headers:t()});return await u(e)}async function w(a,b=[],c={}){await s().acquire();let d=new URLSearchParams({fields:c.fields??r,limit:String(c.limit??20)}),e=`${q}/recommendations/v1/papers/?${d}`,f=await g(e,{method:"POST",headers:t(),body:JSON.stringify({positivePaperIds:a,negativePaperIds:b})});return await u(f)}async function x(a,b=r){await s().acquire();let c=new URLSearchParams({fields:b}),d=`${q}/graph/v1/paper/${encodeURIComponent(a)}?${c}`,e=await g(d,{headers:t()});return await u(e)}async function y(a,b=r,c=1){await s().acquire();let d=new URLSearchParams({query:a,fields:b,limit:String(c)}),e=`${q}/graph/v1/paper/search?${d}`,f=await g(e,{headers:t()});return await u(f)}}};